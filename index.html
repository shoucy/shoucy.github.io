<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>去海边的路上</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="一个写字的人的个人网站">
<meta property="og:type" content="website">
<meta property="og:title" content="去海边的路上">
<meta property="og:url" content="https://shoucy.github.io/index.html">
<meta property="og:site_name" content="去海边的路上">
<meta property="og:description" content="一个写字的人的个人网站">
<meta property="og:locale">
<meta property="article:author" content="Shou Chengyu">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="去海边的路上" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">去海边的路上</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Suche"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://shoucy.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-Docker" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/07/19/Docker/" class="article-date">
  <time class="dt-published" datetime="2021-07-19T14:48:38.000Z" itemprop="datePublished">2021-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/07/19/Docker/">Docker</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Docker-Yes"><a href="#Docker-Yes" class="headerlink" title="Docker? Yes!"></a>Docker? Yes!</h2><p>你是不是有以下苦恼？</p>
<ul>
<li>一款产品，开发与上线搭建两套环境。好麻烦！</li>
<li>部署集群，每台机器都要部署环境（Redis，ES，Hadoop…），各种来回修改修改配置，好麻烦！</li>
<li>开发明明在电脑上可以运行，运维部署上后运行不了，因为版本差异导致服务不能用。运维口吐芬芳！</li>
<li>windows开发一时爽，部署linux火葬场。</li>
<li>开发看运维不爽，想干掉运维，却又不知如何下手。</li>
</ul>
<p>这些问题拥有共同的答案：Docker！</p>
<p><img src="/2021/07/19/Docker/docker-logo.png" alt="docker的logo"></p>
<p>Docker 是一个开源的应用容器引擎，基于 Go 语言 并遵从 Apache2.0 协议开源。</p>
<p>Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。</p>
<p>容器是完全使用沙箱机制，相互之间不会有任何接口（类似 iPhone 的 app）,更重要的是容器性能开销极低。</p>
<p>官网：<a target="_blank" rel="noopener" href="https://www.docker.com/">https://www.docker.com/</a></p>
<h2 id="Docker的历史"><a href="#Docker的历史" class="headerlink" title="Docker的历史"></a>Docker的历史</h2><p>2010年搞IT的几个年轻人，在美国成立了一家公司——<strong>DotCloud</strong>。通过paas的云计算服务。他们将自己的容器化技术，命名为Docker。</p>
<p>Docker起步阶段，没有引起行业的注意，DotCloud眼看凉凉。2013年为了将技术延续下去，决定将Docker开源，一开惊人，越来越多人发现了Docker的优点！</p>
<p>2014年4月9日，Docker1.0发布！</p>
<h2 id="Docker与虚拟机的对比"><a href="#Docker与虚拟机的对比" class="headerlink" title="Docker与虚拟机的对比"></a>Docker与虚拟机的对比</h2><p>虚拟机：</p>
<ul>
<li>虚拟机是一种虚拟技术，完成的虚拟一台完整的操作系统，然后在这套虚拟系统安装和运行软件。</li>
<li>使用虚拟机占用资源十分多，冗余步骤多，启动很慢。</li>
</ul>
<p>Docker：</p>
<ul>
<li>容器化技术并不是模拟一个完整的操作系统，它没有自己的内核，也不虚拟硬件。容器内的应用直接运行在宿主机。</li>
<li>每个容器内都有属于自己的文件系统，互不影响。</li>
<li>一台物理机可以运行多个Docker实例。</li>
<li>Docker容器技术，也是一种虚拟技术。Docker容器只虚拟最核心的环境，只有4兆，十分轻巧，秒级启动。</li>
</ul>
<h2 id="DevOps"><a href="#DevOps" class="headerlink" title="DevOps"></a>DevOps</h2><p>既是开发人员，又是运维人员。DevOps可以更快的交付和部署。</p>
<p>Docker让你一键运行打包镜像，发布测试。</p>
<p>Docker让你的开发、测试、生产高度一致。让你开发测试部署一条龙给客户提供服务。</p>
<h2 id="Docker安装"><a href="#Docker安装" class="headerlink" title="Docker安装"></a>Docker安装</h2><h3 id="卸载旧的Docker"><a href="#卸载旧的Docker" class="headerlink" title="卸载旧的Docker"></a>卸载旧的Docker</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> yum remove docker \</span></span><br><span class="line"><span class="bash">             docker-client \</span></span><br><span class="line"><span class="bash">             docker-client-latest \</span></span><br><span class="line"><span class="bash">             docker-common \</span></span><br><span class="line"><span class="bash">             docker-latest \</span></span><br><span class="line"><span class="bash">             docker-latest-logrotate \</span></span><br><span class="line"><span class="bash">             docker-logrotate \</span></span><br><span class="line"><span class="bash">             docker-engine</span></span><br></pre></td></tr></table></figure>

<h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> yum install -y yum-utils</span></span><br></pre></td></tr></table></figure>

<h3 id="设置镜像的仓库"><a href="#设置镜像的仓库" class="headerlink" title="设置镜像的仓库"></a>设置镜像的仓库</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> yum-config-manager \</span></span><br><span class="line"><span class="bash">    --add-repo \</span></span><br><span class="line"><span class="bash">    https://download.docker.com/linux/centos/docker-ce.repo</span></span><br></pre></td></tr></table></figure>

<h3 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> yum install docker-ce docker-ce-cli containerd.io</span></span><br></pre></td></tr></table></figure>

<p>ps: docker-ce是社区版，ee是企业版。</p>
<h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> systemctl start docker</span></span><br></pre></td></tr></table></figure>

<p>跑个helloword：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker run hello-world</span></span><br><span class="line"></span><br><span class="line">Hello from Docker!</span><br><span class="line">This message shows that your installation appears to be working correctly.</span><br><span class="line"></span><br><span class="line">To generate this message, Docker took the following steps:</span><br><span class="line"> 1. The Docker client contacted the Docker daemon.</span><br><span class="line"> 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.</span><br><span class="line">    (amd64)</span><br><span class="line"> 3. The Docker daemon created a new container from that image which runs the</span><br><span class="line">    executable that produces the output you are currently reading.</span><br><span class="line"> 4. The Docker daemon streamed that output to the Docker client, which sent it</span><br><span class="line">    to your terminal.</span><br><span class="line"></span><br><span class="line">To try something more ambitious, you can run an Ubuntu container with:</span><br><span class="line"><span class="meta"> $</span><span class="bash"> docker run -it ubuntu bash</span></span><br><span class="line"></span><br><span class="line">Share images, automate workflows, and more with a free Docker ID:</span><br><span class="line"> https://hub.docker.com/</span><br><span class="line"></span><br><span class="line">For more examples and ideas, visit:</span><br><span class="line"> https://docs.docker.com/get-started/</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 卸载软件</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> yum remove docker-ce docker-ce-cli containerd.io</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 卸载后删除目录</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> rm -rf /var/lib/docker</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> rm -rf /var/lib/containerd</span></span><br></pre></td></tr></table></figure>



<h2 id="底层原理"><a href="#底层原理" class="headerlink" title="底层原理"></a>底层原理</h2><h3 id="Docker是如何工作的？"><a href="#Docker是如何工作的？" class="headerlink" title="Docker是如何工作的？"></a>Docker是如何工作的？</h3><p>一图胜千言：</p>
<p><img src="/2021/07/19/Docker/architecture.svg" alt="Docker Architecture Diagram"></p>
<p>Docker是一个Client-Server结构的系统，Docker的守护进程运行在主机上。通过Socket从客户端访问！</p>
<p>DockerServer接收到Docker-Client的指令，就会执行这个命令。</p>
<h3 id="Images"><a href="#Images" class="headerlink" title="Images"></a>Images</h3><p>镜像是一种轻量级、可执行的独立软件包，用来打包运行环境和基于此环境开发的软件，它包含某个软件需要的所有内容，包括代码、运行时、库、环境变量和配置文件。</p>
<p>所有的应用，直接打包docker镜像，就可以直接跑起来。</p>
<p>如何得到镜像呢？</p>
<ol>
<li>从远程仓库下载</li>
<li>拷贝</li>
<li><strong>制作一个镜像DockerFile</strong></li>
</ol>
<h3 id="联合文件系统"><a href="#联合文件系统" class="headerlink" title="联合文件系统"></a>联合文件系统</h3><p>联合文件系统（UnionFS）是一种分层、轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下。<br>联合文件系统是 Docker 镜像的基础。镜像可以通过分层来进行继承，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。</p>
<h2 id="Docker命令"><a href="#Docker命令" class="headerlink" title="Docker命令"></a>Docker命令</h2><p>最常用的一些命令：</p>
<p><img src="/2021/07/19/Docker/command-line.jpg" alt="docker常用命令"></p>
<p>详情见文档：<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/run/">https://docs.docker.com/engine/reference/run/</a></p>
<p>查阅docker信息：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 版本</span></span><br><span class="line">docker version</span><br><span class="line"><span class="meta">#</span><span class="bash"> 镜像和容器的信息</span></span><br><span class="line">docker info</span><br><span class="line"><span class="meta">#</span><span class="bash"> 帮助文档</span></span><br><span class="line">dicker 命令 --help</span><br></pre></td></tr></table></figure>



<h3 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h3><p>文档：<a target="_blank" rel="noopener" href="https://docs.docker.com/reference/">https://docs.docker.com/reference/</a></p>
<h4 id="docker-images"><a href="#docker-images" class="headerlink" title="docker images"></a>docker images</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker images</span></span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">mysql         latest    c8562eaf9d81   6 months ago    546MB</span><br><span class="line">centos        latest    300e315adb2f   7 months ago    209MB</span><br><span class="line">hello-world   latest    bf756fb1ae65   18 months ago   13.3kB		</span><br></pre></td></tr></table></figure>

<p>具体解释如下：</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td>RESPOSITORY</td>
<td>镜像的仓库源</td>
</tr>
<tr>
<td>TAG</td>
<td>镜像的标签(版本)</td>
</tr>
<tr>
<td>IMAGE ID</td>
<td>镜像的ID</td>
</tr>
<tr>
<td>CREATED</td>
<td>镜像创建时间</td>
</tr>
<tr>
<td>SIZE</td>
<td>镜像大小</td>
</tr>
</tbody></table>
<p>常用可选项：</p>
<table>
<thead>
<tr>
<th>缩写</th>
<th>完整</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>–all</td>
<td>列出所有镜像</td>
</tr>
<tr>
<td>-q</td>
<td>–queit</td>
<td>只显示镜像的id</td>
</tr>
</tbody></table>
<h4 id="docker-search"><a href="#docker-search" class="headerlink" title="docker search"></a>docker search</h4><p>搜索镜像的命令。</p>
<p>但还是建议去官方的Docker Hub搜索，信息更全。</p>
<p>Docker Hub：<a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com/</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker search mysql</span></span><br><span class="line">NAME                       DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">mysql                      MySQL is a widely used, open-source relation…   11138     [OK]       </span><br><span class="line">mariadb                    MariaDB Server is a high performing open sou…   4221      [OK]       </span><br><span class="line">mysql/mysql-server         Optimized MySQL Server Docker images. Create…   829                  [OK]</span><br><span class="line">centos/mysql-57-centos7    MySQL 5.7 SQL database server                   89                   </span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h4 id="docker-pull"><a href="#docker-pull" class="headerlink" title="docker pull"></a>docker pull</h4><p>拉取镜像</p>
<p>以下载mysql为例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker pull mysql <span class="comment"># 如果要指定版本，就docker pull mysql[:tag]</span></span></span><br><span class="line">Using default tag: latest # 默认latest</span><br><span class="line">latest: Pulling from library/mysql</span><br><span class="line">b4d181a07f80: Pull complete # 分层下载，联合文件系统，docker image的核心。</span><br><span class="line">a462b60610f5: Pull complete </span><br><span class="line">578fafb77ab8: Pull complete </span><br><span class="line">524046006037: Pull complete </span><br><span class="line">d0cbe54c8855: Pull complete </span><br><span class="line">aa18e05cc46d: Pull complete </span><br><span class="line">32ca814c833f: Pull complete </span><br><span class="line">9ecc8abdb7f5: Pull complete </span><br><span class="line">ad042b682e0f: Pull complete </span><br><span class="line">71d327c6bb78: Pull complete </span><br><span class="line">165d1d10a3fa: Pull complete </span><br><span class="line">2f40c47d0626: Pull complete </span><br><span class="line">Digest: sha256:52b8406e4c32b8cf0557f1b74517e14c5393aff5cf0384eff62d9e81f4985d4b # 签名</span><br><span class="line">Status: Downloaded newer image for mysql:latest # 真实地址</span><br><span class="line">docker.io/library/mysql:latest</span><br></pre></td></tr></table></figure>

<h4 id="docker-rmi"><a href="#docker-rmi" class="headerlink" title="docker rmi"></a>docker rmi</h4><p>删除镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ docker rmi c8562eaf9d81</span><br><span class="line">Untagged: mysql@sha256:feada149cb8ff54eade1336da7c1d080c4a1c7ed82b5e320efb5beebed85ae8c</span><br><span class="line">Deleted: sha256:c8562eaf9d81c779cbfc318d6e01b8e6f86907f1d41233268a2ed83b2f34e748</span><br><span class="line">Deleted: sha256:1b649b85960473808c6b812fc30c3f6a3ff1c0ffdcba5c9435daf01cf7d5373a</span><br><span class="line">Deleted: sha256:19cc889447050c16c797fd209fa114ee219de23facb37c00d4137a4ed4aad922</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<h3 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h3><h4 id="docker-run"><a href="#docker-run" class="headerlink" title="docker run"></a>docker run</h4><p>创建容器并启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run [可选参数] image</span><br></pre></td></tr></table></figure>

<p>常用可选参数：</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>–name=”foo”</td>
<td>指定容器名称</td>
</tr>
<tr>
<td>-d</td>
<td>后台运行</td>
</tr>
<tr>
<td>-it</td>
<td>交互式运行，进入容器查看内容</td>
</tr>
<tr>
<td>-p</td>
<td>指定容器端口</td>
</tr>
</tbody></table>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 进入容器</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> docker run -it centos /bin/bash</span></span><br><span class="line">[root@c663294f668f /]# ls</span><br><span class="line">bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line"><span class="meta">#</span><span class="bash"> 退出</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">exit</span></span>    </span><br><span class="line">exit</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看正在运行的容器</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> docker ps</span></span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line"><span class="meta">#</span><span class="bash"> 现在与历史运行过的容器</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> docker ps -a</span></span><br><span class="line">CONTAINER ID   IMAGE         COMMAND       CREATED          STATUS                       PORTS     NAMES</span><br><span class="line">c663294f668f   centos        &quot;/bin/bash&quot;   11 minutes ago   Exited (127) 6 minutes ago             recursing_gould</span><br><span class="line">9d91f4a82687   hello-world   &quot;/hello&quot;      8 hours ago      Exited (0) 8 hours ago                 frosty_snyder</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>关于退出容器</p>
<ul>
<li>exit：直接结束容器运行</li>
<li>ctrl + p + q：容器在不停止的情况退出命令行</li>
</ul>
<h4 id="docker-rm"><a href="#docker-rm" class="headerlink" title="docker rm"></a>docker rm</h4><p>删除指定容器</p>
<p>全部删除：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@bibiboy ~]# docker rm -f $(docker ps -aq)</span><br><span class="line">c663294f668f</span><br><span class="line">9d91f4a82687</span><br><span class="line">7e4410476a9d</span><br><span class="line">c55bb8d50716</span><br><span class="line">1693844328e6</span><br><span class="line">035a227f634a</span><br><span class="line">000b68316321</span><br></pre></td></tr></table></figure>

<h4 id="docker-start-restart-stop-kill"><a href="#docker-start-restart-stop-kill" class="headerlink" title="docker start/restart/stop/kill"></a>docker start/restart/stop/kill</h4><ul>
<li>docker start：启动</li>
<li>docker restart：重启</li>
<li>docker stop：停止</li>
<li>docker kill：强制关闭</li>
</ul>
<h4 id="docker-logs"><a href="#docker-logs" class="headerlink" title="docker logs"></a>docker logs</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看日志，需要提供容器id,本示例所使用的CONTAINER ID为1c21173fb470</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> docker logs 1c21173fb470</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 带时间戳的日志</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> docker logs -tf 1c21173fb470</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 控制显示条数</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> docker logs --tail 10 1c21173fb470</span></span><br></pre></td></tr></table></figure>

<h4 id="docker-top"><a href="#docker-top" class="headerlink" title="docker top"></a>docker top</h4><p>查看容器内的进程信息，需要提供容器id</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker top 1c21173fb470</span></span><br><span class="line">UID      PID      PPID      C      STIME      TTY       TIME      CMD</span><br><span class="line">root     30254    30234     4      21:03      pts/0     00:00:00  /bin/bas</span><br></pre></td></tr></table></figure>

<h4 id="docker-inspect"><a href="#docker-inspect" class="headerlink" title="docker inspect"></a>docker inspect</h4><p>显示指定容器的详细信息，需提供容器id</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect 1c21173fb470</span><br></pre></td></tr></table></figure>

<h4 id="docker-exec"><a href="#docker-exec" class="headerlink" title="docker exec"></a>docker exec</h4><p>进入一个容器，并打开一个命令行工具。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it 1c21173fb470 /bin/bash</span><br></pre></td></tr></table></figure>

<h4 id="docker-attach"><a href="#docker-attach" class="headerlink" title="docker attach"></a>docker attach</h4><p>进入容器，并使用容器正在运行的命令行。</p>
<p>这在个人使用时很方便，但在多人使用时会出现共用控制台的情形。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker attach 1c21173fb470</span></span><br></pre></td></tr></table></figure>

<h4 id="docker-cp"><a href="#docker-cp" class="headerlink" title="docker cp"></a>docker cp</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> docker cp 容器id:容器内路径 目的地主机路径</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> docker cp 1c21173fb470:/root/dove.txt ./</span></span><br></pre></td></tr></table></figure>

<h4 id="docker-states"><a href="#docker-states" class="headerlink" title="docker states"></a>docker states</h4><p>检查各容器状态，主要用来查看cpu和内存的占用情况。</p>
<h3 id="容器与镜像之间"><a href="#容器与镜像之间" class="headerlink" title="容器与镜像之间"></a>容器与镜像之间</h3><h4 id="commit"><a href="#commit" class="headerlink" title="commit"></a>commit</h4><p>提交容器成为一个新的镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker commit -m=<span class="string">&quot;提交的描述信息&quot;</span> -a=<span class="string">&quot;作者&quot;</span> 容器id 目标镜像名[:tag]</span></span><br></pre></td></tr></table></figure>



<h2 id="容器数据卷"><a href="#容器数据卷" class="headerlink" title="容器数据卷"></a>容器数据卷</h2><p>docker的作用就是将环境与应用打包成镜像。但是数据怎么办呢？容器一删，数据就无了。</p>
<p>删库跑路so easy~</p>
<p>数据库产生的数据肯定是不能在容器中的！</p>
<p>Docker容器之间有种数据共享技术——数据卷！数据卷可以将Docker容器中产生的数据，同步到本地，也就是将容器内的目录挂载在Linux上。甚至可以做到容器间的数据共享。</p>
<h3 id="方式一：使用命令-v挂载"><a href="#方式一：使用命令-v挂载" class="headerlink" title="方式一：使用命令-v挂载"></a>方式一：使用命令<code>-v</code>挂载</h3><p>在使用 <code>run</code> 时追加 <code>-v 宿主机目录:容器目录</code> 的形式在实现挂载。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker run -it -v /home/<span class="built_in">test</span>:/home centos /bin/bash</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> home/</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> touch test.test</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Ctrl + P + Q 退出容器</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> /home/<span class="built_in">test</span>/ <span class="comment"># docker自动创建了这个文件夹</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls</span></span><br><span class="line">test.test</span><br><span class="line"><span class="meta">$</span><span class="bash"> docker inspect c43d7f988b94 <span class="comment"># 查寻容器信息，可以找到挂载信息</span></span></span><br><span class="line">...</span><br><span class="line">&quot;Mounts&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;bind&quot;,</span><br><span class="line">                &quot;Source&quot;: &quot;/home/test&quot;,</span><br><span class="line">                &quot;Destination&quot;: &quot;/home&quot;,</span><br><span class="line">                &quot;Mode&quot;: &quot;&quot;,</span><br><span class="line">                &quot;RW&quot;: true,</span><br><span class="line">                &quot;Propagation&quot;: &quot;rprivate&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>mysql挂载：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker pull mysql5.7</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7</span></span><br></pre></td></tr></table></figure>

<h4 id="具名与匿名挂载"><a href="#具名与匿名挂载" class="headerlink" title="具名与匿名挂载"></a>具名与匿名挂载</h4><p>具名挂载：指定宿主机的挂载路径以及容器的挂载路径。</p>
<p>匿名挂载：只写容器内的路径，不写容器外的。会默认映射到docker容器的工作路径（<code>/var/lib/docker/volumes/xxx/_data</code>）。</p>
<h3 id="方式二：使用DockerFile"><a href="#方式二：使用DockerFile" class="headerlink" title="方式二：使用DockerFile"></a>方式二：使用DockerFile</h3><p>docker file就是用来构建docker镜像的构建文件。</p>
<p>举个栗子：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> centos</span><br><span class="line"></span><br><span class="line"><span class="keyword">VOLUME</span><span class="bash"> [<span class="string">&quot;volume01&quot;</span>,<span class="string">&quot;volume02&quot;</span>] <span class="comment"># 挂载了两个目录，还是匿名的</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> <span class="built_in">echo</span> <span class="string">&quot;------end------&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> /bin/bash</span></span><br></pre></td></tr></table></figure>

<p>如果没有在构建时指明挂载，那就只能在创建容器时手动 <code>-v</code> 了。</p>
<p><code>--volumes-from</code> 可以实现容器间的数据共享。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shoucy.github.io/2021/07/19/Docker/" data-id="ckrgf8jil000a1svh39tif63a" data-title="Docker" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-logging" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/07/11/logging/" class="article-date">
  <time class="dt-published" datetime="2021-07-11T11:40:51.000Z" itemprop="datePublished">2021-07-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">编程学习笔记</a>►<a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/07/11/logging/">logging——python日志模块</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="logging？alright"><a href="#logging？alright" class="headerlink" title="logging？alright"></a>logging？alright</h3><p>logging是python的内置日志标准库，它很强大，以至于你不需要再考虑学习与使用第三方库。</p>
<p>日志是对软件执行时所发生事件的一种追踪方式。软件开发人员对他们的代码添加日志调用，借此来指示某事件的发生。一个事件通过一些包含变量数据的描述信息来描述（比如：每个事件发生时的数据都是不同的）。开发者还会区分事件的重要性，重要性也被称为 <em>等级</em> 或 <em>严重性</em>。</p>
<h3 id="萌新教程"><a href="#萌新教程" class="headerlink" title="萌新教程"></a>萌新教程</h3><h4 id="日志级别"><a href="#日志级别" class="headerlink" title="日志级别"></a>日志级别</h4><p>日志功能应以所追踪事件级别或严重性而定。各级别适用性如下（以严重性递增）：</p>
<table>
<thead>
<tr>
<th align="left">级别</th>
<th align="left">何时使用</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>DEBUG</code></td>
<td align="left">细节信息，仅当诊断问题时适用。</td>
</tr>
<tr>
<td align="left"><code>INFO</code></td>
<td align="left">确认程序按预期运行。</td>
</tr>
<tr>
<td align="left"><code>WARNING</code></td>
<td align="left">表明有已经或即将发生的意外（例如：磁盘空间不足）。程序仍按预期进行。</td>
</tr>
<tr>
<td align="left"><code>ERROR</code></td>
<td align="left">由于严重的问题，程序的某些功能已经不能正常执行</td>
</tr>
<tr>
<td align="left"><code>CRITICAL</code></td>
<td align="left">严重的错误，表明程序已不能继续执行</td>
</tr>
</tbody></table>
<p><strong>默认的级别是 <code>WARNING</code>，意味着只会追踪该级别及以上的事件，除非更改日志配置。</strong></p>
<p>一个简单的例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.debug(<span class="string">&#x27;debug message&#x27;</span>)</span><br><span class="line">logging.info(<span class="string">&#x27;info message&#x27;</span>)</span><br><span class="line">logging.warning(<span class="string">&#x27;warn message&#x27;</span>)</span><br><span class="line">logging.error(<span class="string">&#x27;error message&#x27;</span>)</span><br><span class="line">logging.critical(<span class="string">&#x27;critical message&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WARNING:root:warn message</span><br><span class="line">ERROR:root:error message</span><br><span class="line">CRITICAL:root:critical message</span><br></pre></td></tr></table></figure>

<p>而如果在输出日志前增加一行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logging.basicConfig(level=logging.DEBUG)</span><br></pre></td></tr></table></figure>

<p>修改后是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(level=logging.DEBUG)</span><br><span class="line">logging.debug(<span class="string">&#x27;debug message&#x27;</span>)</span><br><span class="line">logging.info(<span class="string">&#x27;info message&#x27;</span>)</span><br><span class="line">logging.warning(<span class="string">&#x27;warn message&#x27;</span>)</span><br><span class="line">logging.error(<span class="string">&#x27;error message&#x27;</span>)</span><br><span class="line">logging.critical(<span class="string">&#x27;critical message&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>运行结果变为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DEBUG:root:debug message</span><br><span class="line">INFO:root:info message</span><br><span class="line">WARNING:root:warn message</span><br><span class="line">ERROR:root:error message</span><br><span class="line">CRITICAL:root:critical message</span><br></pre></td></tr></table></figure>



<h4 id="记录日志到文件"><a href="#记录日志到文件" class="headerlink" title="记录日志到文件"></a>记录日志到文件</h4><p>所追踪事件可以以不同形式处理。最简单的方式是输出到控制台。另一种常用的方式是写入磁盘文件。</p>
<p>要实现输出到文件，通过 <em>filename</em> 参数即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(filename=<span class="string">&#x27;example.log&#x27;</span>, level=logging.DEBUG)</span><br><span class="line">logging.debug(<span class="string">&#x27;This message should go to the log file&#x27;</span>)</span><br><span class="line">logging.info(<span class="string">&#x27;So should this&#x27;</span>)</span><br><span class="line">logging.warning(<span class="string">&#x27;And this, too&#x27;</span>)</span><br><span class="line">logging.error(<span class="string">&#x27;And non-ASCII stuff, too, like Øresund and Malmö&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>增加 <em>filename</em> 参数后，控制台不再输出，而本地多了<code>example.log</code>文件，文件内内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DEBUG:root:This message should go to the log file</span><br><span class="line">INFO:root:So should this</span><br><span class="line">WARNING:root:And this, too</span><br><span class="line">ERROR:root:And non-ASCII stuff, too, like \xd8resund and Malm\xf6</span><br></pre></td></tr></table></figure>

<p>这样我们就实现了将日志输出到文件。</p>
<p>一点小问题：很明显，最后一行出现了字符编码错误。在 python3.9 版后，增加了 <em>encoding</em> 参数以解决此问题。在更早的 Python 版本中或没有指定时，编码会用 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/functions.html#open"><code>open()</code></a> 使用的默认值。</p>
<h4 id="日志の格式"><a href="#日志の格式" class="headerlink" title="日志の格式"></a>日志の格式</h4><p>可以通过 <em>format</em> 参数更改：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(<span class="built_in">format</span>=<span class="string">&quot;%(asctime)s|%(levelname)s|%(filename)s:%(lineno)d|%(message)s&quot;</span>, level=logging.DEBUG)</span><br><span class="line">logging.debug(<span class="string">&#x27;This message should go to the log file&#x27;</span>)</span><br><span class="line">logging.info(<span class="string">&#x27;So should this&#x27;</span>)</span><br><span class="line">logging.warning(<span class="string">&#x27;And this, too&#x27;</span>)</span><br><span class="line">logging.error(<span class="string">&#x27;And non-ASCII stuff, too, like Øresund and Malmö&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2021-07-05 22:16:17,823|DEBUG|test 01.py:4|This message should go to the log file</span><br><span class="line">2021-07-05 22:16:17,823|INFO|test 01.py:5|So should this</span><br><span class="line">2021-07-05 22:16:17,823|WARNING|test 01.py:6|And this, too</span><br><span class="line">2021-07-05 22:16:17,824|ERROR|test 01.py:7|And non-ASCII stuff, too, like Øresund and Malmö</span><br></pre></td></tr></table></figure>

<p>请注意，前面示例中出现的 “root” 已消失。 对于可以出现在格式字符串中的全部内容，你可以参考以下文档 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/logging.html#logrecord-attributes">LogRecord 属性</a> 。</p>
<p>若要修改时间显示的格式，可以向 <code>basicConfig</code> 提供 <em>datefmt</em> 参数，比如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line">logging.basicConfig(<span class="built_in">format</span>=<span class="string">&#x27;%(asctime)s %(message)s&#x27;</span>, datefmt=<span class="string">&#x27;%m/%d/%Y %I:%M:%S %p&#x27;</span>)</span><br><span class="line">logging.warning(<span class="string">&#x27;is when this event was logged.&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>这会显示如下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">12/12/2010 11:46:36 AM is when this event was logged.</span><br></pre></td></tr></table></figure>

<p><em>datefmt</em> 参数的格式与 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/time.html#time.strftime"><code>time.strftime()</code></a> 支持的格式相同。</p>
<h4 id="坏的做法"><a href="#坏的做法" class="headerlink" title="坏的做法"></a>坏的做法</h4><h5 id="混用logging和print"><a href="#混用logging和print" class="headerlink" title="混用logging和print"></a>混用logging和print</h5><p>先来看一段代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;print message&#x27;</span>)</span><br><span class="line">logging.basicConfig(level=logging.DEBUG)</span><br><span class="line">logging.debug(<span class="string">&#x27;debug message&#x27;</span>)</span><br><span class="line">logging.info(<span class="string">&#x27;info message&#x27;</span>)</span><br><span class="line">logging.warning(<span class="string">&#x27;warn message&#x27;</span>)</span><br><span class="line">logging.error(<span class="string">&#x27;error message&#x27;</span>)</span><br><span class="line">logging.critical(<span class="string">&#x27;critical message&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DEBUG:root:debug message</span><br><span class="line">INFO:root:info message</span><br><span class="line">WARNING:root:warn message</span><br><span class="line">ERROR:root:error message</span><br><span class="line">CRITICAL:root:critical message</span><br><span class="line">print message</span><br></pre></td></tr></table></figure>

<p>logging日志之间的先后顺序是确定的，然而print和logging的先后打印顺序却是不确定的，有时print更早，有时更晚。</p>
<p>因为日志系统为了不影响程序运行速度，是异步且并发的。</p>
<p><strong>建议print与logging不要同时使用</strong>。</p>
<h3 id="高级应用"><a href="#高级应用" class="headerlink" title="高级应用"></a>高级应用</h3><p>现在，将刚才学到的代码都忘掉吧！我们不可能用那么麻烦的方式输出日志。</p>
<p>当然，如果你已将之前的知识掌握，那么概念与印象会留在脑海中一直帮助你学习后面的姿势。</p>
<p>日志库采用模块化方法，并提供几类组件：记录器、处理器、过滤器和格式器。</p>
<ul>
<li>记录器（loggers）提供应用程序的调用接口。</li>
<li>处理器（handlers）将日志记录（由记录器创建）发送到适当的目标。</li>
<li>过滤器（filters）提供了更精细的附加功能，用于确定要输出的日志记录。</li>
<li>格式器（formatter）指定最终输出中日志记录的样式。</li>
</ul>
<p><img src="/2021/07/11/logging/image-20210705223833117.png" alt="logger的创建及使用"></p>
<h4 id="Logger"><a href="#Logger" class="headerlink" title="Logger"></a>Logger</h4><ol>
<li><p>提供应用程序的调用接口，公开了几种方法，以便应用程序可以在运行时记录消息。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># logger是单例的，我们通过名字获取了logger，或者如果没有则返回 root。</span></span><br><span class="line">logger = logging.getLogger(__name__)</span><br></pre></td></tr></table></figure></li>
<li><p>决定日志记录的级别。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定记录器将处理的最低严重性日志消息</span></span><br><span class="line">logger.setLevel()</span><br></pre></td></tr></table></figure>
<p> 例如，如果严重性级别为 INFO ，则记录器将仅处理 INFO 、 WARNING 、 ERROR 和 CRITICAL 消息，并将忽略 DEBUG 消息。</p>
</li>
<li><p>将日志内容传递到相关联的handles。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从记录器对象中添加和删除处理器对象。</span></span><br><span class="line">logger.addHandler()</span><br><span class="line">logger.removeHandler()</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>logger的名称</strong></p>
<p>默认为root</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">logger = logging.getLogger()</span><br><span class="line"><span class="built_in">print</span>(logger)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(logger))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;RootLogger root (WARNING)&gt;</span></span><br><span class="line"><span class="string">&lt;class &#x27;logging.RootLogger&#x27;&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>当指定名字后：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">logger = logging.getLogger(<span class="string">&#x27;damon&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(logger)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(logger))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;Logger damon (WARNING)&gt;</span></span><br><span class="line"><span class="string">&lt;class &#x27;logging.Logger&#x27;&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>类型也发生了改变。</p>
<h4 id="Handlers"><a href="#Handlers" class="headerlink" title="Handlers"></a>Handlers</h4><p>它们将日志分发到不同的目的地。可以是文件、标准输出、邮件、或者通过socket、html等协议发送到任何地方。</p>
<p>最常用的handler主要有：</p>
<p><strong>StreamHandler</strong></p>
<p>标准输出stdout（如显示器）分发器。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh = logging.StreamHandler(Stream=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<p><strong>FileHandler</strong></p>
<p>继承自StreamHandler，将日志保存到磁盘文件处理器。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fh = logging.FileHandler(filename, mode=<span class="string">&#x27;a&#x27;</span>, encoding=<span class="literal">None</span>, delay=<span class="literal">False</span>, errors=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<p>当然，还有其他的，其中这两个是很好用的：</p>
<p><code>RotatingFileHandler</code> 实例将消息发送到硬盘文件，支持最大日志文件大小和日志文件轮换。</p>
<p><code>TimedRotatingFileHandler</code> 实例将消息发送到硬盘文件，以特定的时间间隔轮换日志文件。</p>
<h4 id="Formatter"><a href="#Formatter" class="headerlink" title="Formatter"></a>Formatter</h4><p>格式化器对象配置日志消息的最终顺序、结构和内容。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ft = logging.Formatter.__init__(fmt=<span class="literal">None</span>, datefmt=<span class="literal">None</span>, style=<span class="string">&#x27;%&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>比如我们可以把格式设定为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;%(asctime)s - %(levelname)s - %(message)s&#x27;</span><br></pre></td></tr></table></figure>

<p>上面出现的特殊格式的属性为  <em>LogRecord</em>  ，以下有更多的 <em>LogRecord</em> 属性可以参考：</p>
<table>
<thead>
<tr>
<th align="left">属性名称</th>
<th align="left">格式</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">args</td>
<td align="left">此属性不需要用户进行格式化。</td>
<td align="left">合并到 <code>msg</code> 以产生 <code>message</code> 的包含参数的元组，或是其中的值将被用于合并的字典（当只有一个参数且其类型为字典时）。</td>
</tr>
<tr>
<td align="left">asctime</td>
<td align="left"><code>%(asctime)s</code></td>
<td align="left">表示 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.9/library/logging.html#logging.LogRecord"><code>LogRecord</code></a> 何时被创建的供人查看时间值。 默认形式为 ‘2003-07-08 16:49:45,896’ （逗号之后的数字为时间的毫秒部分）。</td>
</tr>
<tr>
<td align="left">created</td>
<td align="left"><code>%(created)f</code></td>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.9/library/logging.html#logging.LogRecord"><code>LogRecord</code></a> 被创建的时间（即 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.9/library/time.html#time.time"><code>time.time()</code></a> 的返回值）。</td>
</tr>
<tr>
<td align="left">exc_info</td>
<td align="left">此属性不需要用户进行格式化。</td>
<td align="left">异常元组（例如 <code>sys.exc_info</code>）或者如未发生异常则为 <code>None</code>。</td>
</tr>
<tr>
<td align="left">filename</td>
<td align="left"><code>%(filename)s</code></td>
<td align="left"><code>pathname</code> 的文件名部分。</td>
</tr>
<tr>
<td align="left">funcName</td>
<td align="left"><code>%(funcName)s</code></td>
<td align="left">函数名包括调用日志记录.</td>
</tr>
<tr>
<td align="left">levelname</td>
<td align="left"><code>%(levelname)s</code></td>
<td align="left">消息文本记录级别（<code>&#39;DEBUG&#39;</code>，<code>&#39;INFO&#39;</code>，<code>&#39;WARNING&#39;</code>，<code>&#39;ERROR&#39;</code>，<code>&#39;CRITICAL&#39;</code>）。</td>
</tr>
<tr>
<td align="left">levelno</td>
<td align="left"><code>%(levelno)s</code></td>
<td align="left">消息数字的记录级别 (<code>DEBUG</code>, <code>INFO</code>, <code>WARNING</code>, <code>ERROR</code>, <code>CRITICAL</code>).</td>
</tr>
<tr>
<td align="left">lineno</td>
<td align="left"><code>%(lineno)d</code></td>
<td align="left">发出日志记录调用所在的源行号（如果可用）。</td>
</tr>
<tr>
<td align="left">message</td>
<td align="left"><code>%(message)s</code></td>
<td align="left">记入日志的消息，即 <code>msg % args</code> 的结果。 这是在发起调用 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.9/library/logging.html#logging.Formatter.format"><code>Formatter.format()</code></a> 时设置的。</td>
</tr>
<tr>
<td align="left">module</td>
<td align="left"><code>%(module)s</code></td>
<td align="left">模块 (<code>filename</code> 的名称部分)。</td>
</tr>
<tr>
<td align="left">msecs</td>
<td align="left"><code>%(msecs)d</code></td>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.9/library/logging.html#logging.LogRecord"><code>LogRecord</code></a> 被创建的时间的毫秒部分。</td>
</tr>
<tr>
<td align="left">msg</td>
<td align="left">此属性不需要用户进行格式化。</td>
<td align="left">在原始日志记录调用中传入的格式字符串。 与 <code>args</code> 合并以产生 <code>message</code>，或是一个任意对象 (参见 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.9/howto/logging.html#arbitrary-object-messages">使用任意对象作为消息</a>)。</td>
</tr>
<tr>
<td align="left">name</td>
<td align="left"><code>%(name)s</code></td>
<td align="left">用于记录调用的日志记录器名称。</td>
</tr>
<tr>
<td align="left">pathname</td>
<td align="left"><code>%(pathname)s</code></td>
<td align="left">发出日志记录调用的源文件的完整路径名（如果可用）。</td>
</tr>
<tr>
<td align="left">process</td>
<td align="left"><code>%(process)d</code></td>
<td align="left">进程ID（如果可用）</td>
</tr>
<tr>
<td align="left">processName</td>
<td align="left"><code>%(processName)s</code></td>
<td align="left">进程名（如果可用）</td>
</tr>
<tr>
<td align="left">relativeCreated</td>
<td align="left"><code>%(relativeCreated)d</code></td>
<td align="left">以毫秒数表示的 LogRecord 被创建的时间，即相对于 logging 模块被加载时间的差值。</td>
</tr>
<tr>
<td align="left">stack_info</td>
<td align="left">此属性不需要用户进行格式化。</td>
<td align="left">当前线程中从堆栈底部起向上直到包括日志记录调用并引发创建当前记录堆栈帧创建的堆栈帧信息（如果可用）。</td>
</tr>
<tr>
<td align="left">thread</td>
<td align="left"><code>%(thread)d</code></td>
<td align="left">线程ID（如果可用）</td>
</tr>
<tr>
<td align="left">threadName</td>
<td align="left"><code>%(threadName)s</code></td>
<td align="left">线程名（如果可用）</td>
</tr>
</tbody></table>
<h5 id="关于日志对齐"><a href="#关于日志对齐" class="headerlink" title="关于日志对齐"></a>关于日志对齐</h5><ul>
<li><code>%(levelname)8s</code>:右对齐</li>
<li><code>%(levelname)-8s</code>:左对齐</li>
</ul>
<h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>传统的方式是以<code>.config</code>结尾的方式进行配置。</p>
<p>在 Python 3.2 中，引入了一种新的配置日志记录的方法，使用字典来保存配置信息。 这提供了上述基于配置文件方法的功能的超集，并且是新应用程序和部署的推荐配置方法。 因为 Python 字典用于保存配置信息，并且由于你可以使用不同的方式填充该字典，因此你有更多的配置选项。 例如，你可以使用 JSON 格式的配置文件，或者如果你有权访问 YAML 处理功能，则可以使用 YAML 格式的文件来填充配置字典。当然，你可以在 Python 代码中构造字典，通过套接字以 pickle 形式接收它，或者使用对你的应用程序合理的任何方法。</p>
<p>补充一个我在Django中设计的配置文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">LOGGING = &#123;</span><br><span class="line">    <span class="string">&#x27;version&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&#x27;disable_existing_loggers&#x27;</span>: <span class="literal">False</span>,</span><br><span class="line">    <span class="string">&#x27;formatters&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;verbose&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;format&#x27;</span>: <span class="string">&#x27;%(asctime)s[%(levelname)8s]%(name)s(%(module)s:%(lineno)d) %(funcName)s %(message)s&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;simple&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;format&#x27;</span>: <span class="string">&#x27;&#123;levelname&#125; &#123;message&#125;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;style&#x27;</span>: <span class="string">&#x27;&#123;&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;filters&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;require_debug_false&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;()&#x27;</span>: <span class="string">&#x27;django.utils.log.RequireDebugFalse&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;require_debug_true&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;()&#x27;</span>: <span class="string">&#x27;django.utils.log.RequireDebugTrue&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;handlers&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;console&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;INFO&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;filters&#x27;</span>: [<span class="string">&#x27;require_debug_true&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;logging.StreamHandler&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;formatter&#x27;</span>: <span class="string">&#x27;verbose&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;file&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;WARNING&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;filters&#x27;</span>: [<span class="string">&#x27;require_debug_false&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;logging.handlers.TimedRotatingFileHandler&#x27;</span>,  <span class="comment"># 按时间进行文件切割的文件handler</span></span><br><span class="line">            <span class="string">&#x27;formatter&#x27;</span>: <span class="string">&#x27;verbose&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;filename&#x27;</span>: os.path.join(BASE_LOG_DIR, <span class="string">&#x27;log.log&#x27;</span>),</span><br><span class="line">            <span class="string">&#x27;when&#x27;</span>: <span class="string">&#x27;D&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;backupCount&#x27;</span>: <span class="number">90</span>,  <span class="comment"># 超过90天的日志会被删除</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;loggers&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;&#x27;</span>: &#123;  <span class="comment"># 默认的logger应用如下配置</span></span><br><span class="line">            <span class="string">&#x27;handlers&#x27;</span>: [<span class="string">&#x27;console&#x27;</span>, <span class="string">&#x27;file&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;DEBUG&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;propagate&#x27;</span>: <span class="literal">True</span>  <span class="comment"># 要不要传播到更高级处理</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment"># 类型 为 django 处理所有类型的日志， 默认调用</span></span><br><span class="line">        <span class="string">&#x27;django&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;handlers&#x27;</span>: [<span class="string">&#x27;console&#x27;</span>, <span class="string">&#x27;file&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;DEBUG&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;propagate&#x27;</span>: <span class="literal">False</span>  <span class="comment"># 要不要传播到更高级处理</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h3><h4 id="logger-execption"><a href="#logger-execption" class="headerlink" title="logger.execption()"></a>logger.execption()</h4><p>使用<code>logger.execption()</code>可以传入一个捕获到的异常，将其打印。</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ol>
<li>日志 HOWTO，作者：Vinay Sajip<br><a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/howto/logging.html">https://docs.python.org/zh-cn/3/howto/logging.html</a></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shoucy.github.io/2021/07/11/logging/" data-id="ckrgf8jik00091svhgt5r2tvk" data-title="logging——python日志模块" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-计算机基本概念" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/06/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" class="article-date">
  <time class="dt-published" datetime="2021-06-05T03:17:56.000Z" itemprop="datePublished">2021-06-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">编程学习笔记</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/06/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/">计算机基本概念</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="硬件与软件"><a href="#硬件与软件" class="headerlink" title="硬件与软件"></a>硬件与软件</h2><p>计算机包括硬件（hardware）和软件（software）两个部分。</p>
<ul>
<li>硬件：计算机中可以看见的物理部分。</li>
<li>软件：看不见的指令，这些指令可以控制硬件完成特定的任务。</li>
</ul>
<p>如果将计算机比喻成人类，硬件就是人的肉体，而软件便视人的思想与灵魂。</p>
<h3 id="计算机的硬件"><a href="#计算机的硬件" class="headerlink" title="计算机的硬件"></a>计算机的硬件</h3><ul>
<li>中央处理器（CPU）</li>
<li>内存（主存）</li>
<li>存储设备：硬盘、光盘、磁材、软盘</li>
<li>输入设备：键盘、鼠标</li>
<li>输出设备：显示器、打印机</li>
<li>通信设备：调制解调器（Modem）、网卡</li>
</ul>
<h4 id="冯诺依曼体系结构"><a href="#冯诺依曼体系结构" class="headerlink" title="冯诺依曼体系结构"></a>冯诺依曼体系结构</h4><p><img src="/2021/06/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/faedab64034f78f027f7ddff45577253b2191cae.jpeg" alt="冯诺依曼体系结构"></p>
<ul>
<li><p>中央处理器（Central Processing Unit,CPU）：计算机的大脑，它能从内存中获取指令，然后执行这些指令。中央处理器由两部分构成：运算器、控制器。</p>
<ul>
<li>运算器（即算数/逻辑单元 arithmetic/login unit：完成数值运算（加减乘除）和逻辑运算（比较）。</li>
<li>控制单元：用于控制和协调其他组件的动作。</li>
<li>每台计算机都有一个内部时钟，该时钟以固定的速度发射电子脉冲。时钟速度越快，给定时间内执行的指令就越多。速度的计量单位为<strong>赫兹（Hz）</strong>，1赫兹相当于每秒一个脉冲。随着CPU运算能力的不断提高，目前使用<strong>千兆赫（GHz）</strong>来表述。</li>
<li>最初的CPU只有一个核（core）。核是计算机中实现指令读取和执行的部分。一个多核处理器拥有两个以上的核，可提高cpu的处理能力。</li>
</ul>
</li>
<li><p>存储设备：主要包括，磁盘驱动器（硬盘）、光盘驱动器（CD、DVD），USB闪存驱动器（U盘）等。</p>
</li>
<li><p>内存（Ramdom-Access Memory，RAM）：由一个有序字节数列组成，用于存储程序及程序需要的数据。</p>
<ul>
<li>一个程序和它的数据在被CPU执行前必须移到计算机的内存中。</li>
</ul>
</li>
<li><p>每个字节都有一个唯一的地址，以便于存储和获取数据。</p>
<ul>
<li>一个计算机具有的RAM越多，它的运行速度越快，但此规律只有在内存空间即将不够时有效。</li>
</ul>
</li>
<li><p>内存和CPU一样，也构建在表面嵌有数百万晶体管的半导体芯片上。但内存芯片更简单、低速且便宜。</p>
</li>
<li><p>输入设备：键盘、鼠标</p>
</li>
<li><p>输出设备：显示器、打印机</p>
</li>
</ul>
<h4 id="比特和字节"><a href="#比特和字节" class="headerlink" title="比特和字节"></a>比特和字节</h4><p>比特（bit）：计算机就是一系列的电路开关，每个开关存在两种状态：开（ON）、关（OFF）。如果电路是开的，它就是1，如果是关的，它就是。<strong>一个0或者1存储为1个比特，比特是计算机中最小的存储单位。</strong></p>
<p>字节（byte）：<strong>计算机中最基本的存储单元。每个字节又8个比特构成。</strong></p>
<p>计算机的存储能力通常是以字节和多字节来衡量的，比如：</p>
<ul>
<li>千字节（kilobyte，KB）=1024B（byte）</li>
<li>兆字节（megabyte，MB）=1024KB</li>
<li>千兆字节（gigabyte，GB）=1024MB</li>
<li>万亿字节（terabyte，TB）=1024GB</li>
</ul>
<p>注：10月24日是程序员节，<strong>福利较好的公司</strong>会在该日雇用程序员鼓励师为程序员提供服务。</p>
<h4 id="为什么我们需要内存？"><a href="#为什么我们需要内存？" class="headerlink" title="为什么我们需要内存？"></a>为什么我们需要内存？</h4><p>实测发现：内存的存取速度比硬盘的存取速度快10倍以上，而cpu的数据处理速度比内存的读取速度还要快的多。我们把硬盘的程序放在内存让CPU运行，比直接让CPU在内存运行程序要快得多。所以<strong>内存可以一定程度改善CPU运算过快，而硬盘又读写过慢的问题。</strong></p>
<p>内存与硬盘之间的关系：</p>
<p><img src="/2021/06/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/251d8990924042db0626a6105b4f6b45.png" alt="cpu，内存，硬盘关系图"></p>
<p>内存起到两个作用：</p>
<ol>
<li>保存从硬盘读取的数据，提供给CPU使用。</li>
<li>保存CPU的一些临时执行结果，以便CPU下次使用或存储到硬盘。</li>
</ol>
<p>使用内存我们需要注意：</p>
<ol>
<li>内存是带电存储的，一旦断电数据就会消失。</li>
<li>内存容量有限且珍贵。</li>
<li>内存的存取速度难以提高，反而使用固态硬盘（SSD）可以极大改善硬盘的读写速度。</li>
</ol>
<h4 id="计算机行业发展定律"><a href="#计算机行业发展定律" class="headerlink" title="计算机行业发展定律"></a>计算机行业发展定律</h4><p><strong>摩尔定律</strong></p>
<p>摩尔定律（Moore’s Law）是英特尔创始人之一戈登·摩尔的经验之谈，其核心内容为：集成电路上可以容纳的晶体管数目在大约每经过18个月便会增加一倍。换言之，处理器的性能每隔两年翻一倍。 </p>
<p>摩尔定律是内行人摩尔的经验之谈，汉译名为“定律”，但并非自然科学定律，它一定程度揭示了信息技术进步的速度。 </p>
<p><strong>反摩尔定律</strong></p>
<p>反摩尔定律是Google的前CEO埃里克·施密特提出的：如果你反过来看摩尔定律，一个IT公司如果今天和18个月前卖掉同样多的、同样的产品，它的营业额就要降一半。IT界把它称为反摩尔定律。</p>
<p>反摩尔定律对于所有的IT公司来讲，都是非常可怕的，因为一个IT公司花了同样的劳动，却只得到以前一半的收入。反摩尔定律逼着所有的硬件设备公司必须赶上摩尔定律所规定的更新速度，而所有的硬件和设备生产厂活得都是非常辛苦的。</p>
<p><strong>安迪比尔定律</strong></p>
<p>安迪-比尔定理 （Andy and Bill’s Law）是对IT产业中软件和硬件升级换代关系的一个概括。原话是 “Andy gives, Bill takes away.（安迪提供什么，比尔拿走什么。）” 安迪指英特尔前CEO安迪·格鲁夫，比尔指微软前任CEO比尔·盖茨，这句话的意思是，硬件提高的性能，很快被软件消耗掉了。</p>
<h4 id="计算机发展史上的大佬们"><a href="#计算机发展史上的大佬们" class="headerlink" title="计算机发展史上的大佬们"></a>计算机发展史上的大佬们</h4><h5 id="艾伦·麦席森·图灵"><a href="#艾伦·麦席森·图灵" class="headerlink" title="艾伦·麦席森·图灵"></a>艾伦·麦席森·图灵</h5><p>艾伦·麦席森·图灵（英语：Alan Mathison Turing，1912年6月23日—1954年6月7日），英国数学家、逻辑学家，被称为计算机科学之父，人工智能之父。1931年图灵进入剑桥大学国王学院，毕业后到美国普林斯顿大学攻读博士学位，第二次世界大战爆发后回到剑桥，后曾协助军方破解德国的著名密码系统Enigma，帮助盟军取得了二战的胜利。</p>
<p>1952年，英国政府对图灵的同性恋取向定罪，随后图灵接受化学阉割<em>（雌激素注射）</em>。1954年6月7日，图灵吃下含有氰化物的苹果中毒身亡，享年41岁。2013年12月24日，在英国司法大臣克里斯·格雷灵的要求下，英国女王伊丽莎白二世向图灵颁发了皇家赦免。</p>
<p>图灵对于人工智能的发展有诸多贡献，提出了一种用于判定机器是否具有智能的试验方法，即图灵试验，至今，每年都有试验的比赛。此外，图灵提出的著名的图灵机模型为现代计算机的逻辑工作方式奠定了基础。</p>
<h5 id="约翰·冯·诺依曼"><a href="#约翰·冯·诺依曼" class="headerlink" title="约翰·冯·诺依曼"></a>约翰·冯·诺依曼</h5><p>冯·诺依曼（John von Neumann，1903年12月28日-1957年2月8日），美籍匈牙利数学家、计算机科学家、物理学家，是20世纪最重要的数学家之一。 冯·诺依曼是罗兰大学数学博士，是现代计算机、博弈论、核武器和生化武器等领域内的科学全才之一，被后人称为“现代计算机之父”、“博弈论之父”。 </p>
<p>冯·诺依曼先后执教于柏林大学和汉堡大学，1930年前往美国，后入美国籍。 历任普林斯顿大学教授、普林斯顿高等研究院教授，入选美国原子能委员会会员、美国国家科学院院士。 早期以算子理论、共振论、量子理论、集合论等方面的研究闻名，开创了冯·诺依曼代数。 冯·诺依曼第二次世界大战期间曾参与曼哈顿计划，为第一颗原子弹的研制作出了贡献。 </p>
<p>冯·诺依曼1944年与奥斯卡·摩根斯特恩合著《博弈论与经济行为》，是博弈论学科的奠基性著作。晚年，冯·诺依曼转向研究自动机理论，著有对人脑和计算机系统进行精确分析的著作《计算机与人脑》（1958年），为研制电子数字计算机提供了基础性的方案。 其余主要著作有《量子力学的数学基础》（1926）、《经典力学的算子方法》、《连续几何》（1960）等。 </p>
<h3 id="计算机的软件"><a href="#计算机的软件" class="headerlink" title="计算机的软件"></a>计算机的软件</h3><p>软件，及一些列按照特定顺序组织的计算机数据和指令的集合。有系统软件和应用软件之分。</p>
<h4 id="人机交互方式"><a href="#人机交互方式" class="headerlink" title="人机交互方式"></a>人机交互方式</h4><p>图形化界面（Graphical User Interface，GUI），这种方式简单直观，使用者易于接受，容易上手操作。</p>
<p>命令行方式（Command Line Interface，CLI），需要有一个控制台，输入特定的指令，让计算机完成一些操作。较为麻烦，需要记住指令。</p>
<p>最早的图形化界面是由施乐公司研发的，苹果抄袭（借鉴）了施乐，微软又抄袭（借鉴）了苹果。</p>
<h4 id="常用DOS命令"><a href="#常用DOS命令" class="headerlink" title="常用DOS命令"></a>常用DOS命令</h4><ul>
<li>dir：列出当前目录下的文件或文件夹</li>
<li>md：创建目录</li>
<li>rd：删除目录</li>
<li>cd：进入指定目录</li>
<li>cd..：退回到上一级目录</li>
<li>del：删除文件</li>
<li>exit：退出dos命令行</li>
</ul>
<h4 id="编程语言介绍"><a href="#编程语言介绍" class="headerlink" title="编程语言介绍"></a>编程语言介绍</h4><p>第一代语言：机器语言，以二进制形式存在</p>
<p>第二代语言：汇编语言，使用助记符表示一条机器指令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">a(汇编语言) --&gt;  b[汇编器]--&gt;c(机器代码文件)</span><br></pre></td></tr></table></figure>

<p>第三代语言：高级语言</p>
<ol>
<li>C、Pascal、Fortran等面向过程编程语言</li>
<li>C++兼具面向过程与面向对象</li>
<li>JAVA面向对象</li>
<li>.NET跨平台语言</li>
<li>Python、Scala…</li>
</ol>
<h4 id="软件的应用场景"><a href="#软件的应用场景" class="headerlink" title="软件的应用场景"></a>软件的应用场景</h4><p>除了个人计算机，飞机、汽车、手机、甚至烤面包机中都在运行着程序。</p>
<h3 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h3><p>操作（Operating System）系统是运行在计算机上的最重要的程序，它可以管理和操作计算机的活动。</p>
<p>它可以：</p>
<ul>
<li>控制和监视系统的活动</li>
<li>分配和调配系统资源</li>
<li>调度操作</li>
</ul>
<h3 id="万维网"><a href="#万维网" class="headerlink" title="万维网"></a>万维网</h3><p>万维网WWW是World Wide Web的简称，也称为Web、3W等。WWW是基于客户机/服务器方式的信息发现技术和超文本技术的综合。WWW服务器通过超文本标记语言(HTML)把信息组织成为图文并茂的超文本，利用链接从一个站点跳到另个站点。这样一来彻底摆脱了以前查询工具只能按特定路径一步步地查找信息的限制 。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shoucy.github.io/2021/06/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" data-id="ckrgf8jii00071svhh04zd5h8" data-title="计算机基本概念" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Kategorien</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">编程学习笔记</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/python/">python</a></li></ul></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/07/19/Docker/">Docker</a>
          </li>
        
          <li>
            <a href="/2021/07/11/logging/">logging——python日志模块</a>
          </li>
        
          <li>
            <a href="/2021/06/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/">计算机基本概念</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 Shou Chengyu<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>