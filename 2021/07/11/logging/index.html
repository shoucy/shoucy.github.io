<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>logging——python日志模块 | 去海边的路上</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="logging？alrightlogging是python的内置日志标准库，它很强大，以至于你不需要再考虑学习与使用第三方库。 日志是对软件执行时所发生事件的一种追踪方式。软件开发人员对他们的代码添加日志调用，借此来指示某事件的发生。一个事件通过一些包含变量数据的描述信息来描述（比如：每个事件发生时的数据都是不同的）。开发者还会区分事件的重要性，重要性也被称为 等级 或 严重性。 萌新教程日志级别">
<meta property="og:type" content="article">
<meta property="og:title" content="logging——python日志模块">
<meta property="og:url" content="https://shoucy.github.io/2021/07/11/logging/index.html">
<meta property="og:site_name" content="去海边的路上">
<meta property="og:description" content="logging？alrightlogging是python的内置日志标准库，它很强大，以至于你不需要再考虑学习与使用第三方库。 日志是对软件执行时所发生事件的一种追踪方式。软件开发人员对他们的代码添加日志调用，借此来指示某事件的发生。一个事件通过一些包含变量数据的描述信息来描述（比如：每个事件发生时的数据都是不同的）。开发者还会区分事件的重要性，重要性也被称为 等级 或 严重性。 萌新教程日志级别">
<meta property="og:locale">
<meta property="og:image" content="https://shoucy.github.io/2021/07/11/logging/image-20210705223833117.png">
<meta property="article:published_time" content="2021-07-11T11:40:51.000Z">
<meta property="article:modified_time" content="2021-07-11T14:03:56.559Z">
<meta property="article:author" content="Shou Chengyu">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://shoucy.github.io/2021/07/11/logging/image-20210705223833117.png">
  
    <link rel="alternate" href="/atom.xml" title="去海边的路上" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">去海边的路上</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Suche"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://shoucy.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-logging" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/07/11/logging/" class="article-date">
  <time class="dt-published" datetime="2021-07-11T11:40:51.000Z" itemprop="datePublished">2021-07-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">编程学习笔记</a>►<a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      logging——python日志模块
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="logging？alright"><a href="#logging？alright" class="headerlink" title="logging？alright"></a>logging？alright</h3><p>logging是python的内置日志标准库，它很强大，以至于你不需要再考虑学习与使用第三方库。</p>
<p>日志是对软件执行时所发生事件的一种追踪方式。软件开发人员对他们的代码添加日志调用，借此来指示某事件的发生。一个事件通过一些包含变量数据的描述信息来描述（比如：每个事件发生时的数据都是不同的）。开发者还会区分事件的重要性，重要性也被称为 <em>等级</em> 或 <em>严重性</em>。</p>
<h3 id="萌新教程"><a href="#萌新教程" class="headerlink" title="萌新教程"></a>萌新教程</h3><h4 id="日志级别"><a href="#日志级别" class="headerlink" title="日志级别"></a>日志级别</h4><p>日志功能应以所追踪事件级别或严重性而定。各级别适用性如下（以严重性递增）：</p>
<table>
<thead>
<tr>
<th align="left">级别</th>
<th align="left">何时使用</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>DEBUG</code></td>
<td align="left">细节信息，仅当诊断问题时适用。</td>
</tr>
<tr>
<td align="left"><code>INFO</code></td>
<td align="left">确认程序按预期运行。</td>
</tr>
<tr>
<td align="left"><code>WARNING</code></td>
<td align="left">表明有已经或即将发生的意外（例如：磁盘空间不足）。程序仍按预期进行。</td>
</tr>
<tr>
<td align="left"><code>ERROR</code></td>
<td align="left">由于严重的问题，程序的某些功能已经不能正常执行</td>
</tr>
<tr>
<td align="left"><code>CRITICAL</code></td>
<td align="left">严重的错误，表明程序已不能继续执行</td>
</tr>
</tbody></table>
<p><strong>默认的级别是 <code>WARNING</code>，意味着只会追踪该级别及以上的事件，除非更改日志配置。</strong></p>
<p>一个简单的例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.debug(<span class="string">&#x27;debug message&#x27;</span>)</span><br><span class="line">logging.info(<span class="string">&#x27;info message&#x27;</span>)</span><br><span class="line">logging.warning(<span class="string">&#x27;warn message&#x27;</span>)</span><br><span class="line">logging.error(<span class="string">&#x27;error message&#x27;</span>)</span><br><span class="line">logging.critical(<span class="string">&#x27;critical message&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WARNING:root:warn message</span><br><span class="line">ERROR:root:error message</span><br><span class="line">CRITICAL:root:critical message</span><br></pre></td></tr></table></figure>

<p>而如果在输出日志前增加一行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logging.basicConfig(level=logging.DEBUG)</span><br></pre></td></tr></table></figure>

<p>修改后是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(level=logging.DEBUG)</span><br><span class="line">logging.debug(<span class="string">&#x27;debug message&#x27;</span>)</span><br><span class="line">logging.info(<span class="string">&#x27;info message&#x27;</span>)</span><br><span class="line">logging.warning(<span class="string">&#x27;warn message&#x27;</span>)</span><br><span class="line">logging.error(<span class="string">&#x27;error message&#x27;</span>)</span><br><span class="line">logging.critical(<span class="string">&#x27;critical message&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>运行结果变为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DEBUG:root:debug message</span><br><span class="line">INFO:root:info message</span><br><span class="line">WARNING:root:warn message</span><br><span class="line">ERROR:root:error message</span><br><span class="line">CRITICAL:root:critical message</span><br></pre></td></tr></table></figure>



<h4 id="记录日志到文件"><a href="#记录日志到文件" class="headerlink" title="记录日志到文件"></a>记录日志到文件</h4><p>所追踪事件可以以不同形式处理。最简单的方式是输出到控制台。另一种常用的方式是写入磁盘文件。</p>
<p>要实现输出到文件，通过 <em>filename</em> 参数即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(filename=<span class="string">&#x27;example.log&#x27;</span>, level=logging.DEBUG)</span><br><span class="line">logging.debug(<span class="string">&#x27;This message should go to the log file&#x27;</span>)</span><br><span class="line">logging.info(<span class="string">&#x27;So should this&#x27;</span>)</span><br><span class="line">logging.warning(<span class="string">&#x27;And this, too&#x27;</span>)</span><br><span class="line">logging.error(<span class="string">&#x27;And non-ASCII stuff, too, like Øresund and Malmö&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>增加 <em>filename</em> 参数后，控制台不再输出，而本地多了<code>example.log</code>文件，文件内内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DEBUG:root:This message should go to the log file</span><br><span class="line">INFO:root:So should this</span><br><span class="line">WARNING:root:And this, too</span><br><span class="line">ERROR:root:And non-ASCII stuff, too, like \xd8resund and Malm\xf6</span><br></pre></td></tr></table></figure>

<p>这样我们就实现了将日志输出到文件。</p>
<p>一点小问题：很明显，最后一行出现了字符编码错误。在 python3.9 版后，增加了 <em>encoding</em> 参数以解决此问题。在更早的 Python 版本中或没有指定时，编码会用 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/functions.html#open"><code>open()</code></a> 使用的默认值。</p>
<h4 id="日志の格式"><a href="#日志の格式" class="headerlink" title="日志の格式"></a>日志の格式</h4><p>可以通过 <em>format</em> 参数更改：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(<span class="built_in">format</span>=<span class="string">&quot;%(asctime)s|%(levelname)s|%(filename)s:%(lineno)d|%(message)s&quot;</span>, level=logging.DEBUG)</span><br><span class="line">logging.debug(<span class="string">&#x27;This message should go to the log file&#x27;</span>)</span><br><span class="line">logging.info(<span class="string">&#x27;So should this&#x27;</span>)</span><br><span class="line">logging.warning(<span class="string">&#x27;And this, too&#x27;</span>)</span><br><span class="line">logging.error(<span class="string">&#x27;And non-ASCII stuff, too, like Øresund and Malmö&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2021-07-05 22:16:17,823|DEBUG|test 01.py:4|This message should go to the log file</span><br><span class="line">2021-07-05 22:16:17,823|INFO|test 01.py:5|So should this</span><br><span class="line">2021-07-05 22:16:17,823|WARNING|test 01.py:6|And this, too</span><br><span class="line">2021-07-05 22:16:17,824|ERROR|test 01.py:7|And non-ASCII stuff, too, like Øresund and Malmö</span><br></pre></td></tr></table></figure>

<p>请注意，前面示例中出现的 “root” 已消失。 对于可以出现在格式字符串中的全部内容，你可以参考以下文档 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/logging.html#logrecord-attributes">LogRecord 属性</a> 。</p>
<p>若要修改时间显示的格式，可以向 <code>basicConfig</code> 提供 <em>datefmt</em> 参数，比如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line">logging.basicConfig(<span class="built_in">format</span>=<span class="string">&#x27;%(asctime)s %(message)s&#x27;</span>, datefmt=<span class="string">&#x27;%m/%d/%Y %I:%M:%S %p&#x27;</span>)</span><br><span class="line">logging.warning(<span class="string">&#x27;is when this event was logged.&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>这会显示如下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">12/12/2010 11:46:36 AM is when this event was logged.</span><br></pre></td></tr></table></figure>

<p><em>datefmt</em> 参数的格式与 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/time.html#time.strftime"><code>time.strftime()</code></a> 支持的格式相同。</p>
<h4 id="坏的做法"><a href="#坏的做法" class="headerlink" title="坏的做法"></a>坏的做法</h4><h5 id="混用logging和print"><a href="#混用logging和print" class="headerlink" title="混用logging和print"></a>混用logging和print</h5><p>先来看一段代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;print message&#x27;</span>)</span><br><span class="line">logging.basicConfig(level=logging.DEBUG)</span><br><span class="line">logging.debug(<span class="string">&#x27;debug message&#x27;</span>)</span><br><span class="line">logging.info(<span class="string">&#x27;info message&#x27;</span>)</span><br><span class="line">logging.warning(<span class="string">&#x27;warn message&#x27;</span>)</span><br><span class="line">logging.error(<span class="string">&#x27;error message&#x27;</span>)</span><br><span class="line">logging.critical(<span class="string">&#x27;critical message&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DEBUG:root:debug message</span><br><span class="line">INFO:root:info message</span><br><span class="line">WARNING:root:warn message</span><br><span class="line">ERROR:root:error message</span><br><span class="line">CRITICAL:root:critical message</span><br><span class="line">print message</span><br></pre></td></tr></table></figure>

<p>logging日志之间的先后顺序是确定的，然而print和logging的先后打印顺序却是不确定的，有时print更早，有时更晚。</p>
<p>因为日志系统为了不影响程序运行速度，是异步且并发的。</p>
<p><strong>建议print与logging不要同时使用</strong>。</p>
<h3 id="高级应用"><a href="#高级应用" class="headerlink" title="高级应用"></a>高级应用</h3><p>现在，将刚才学到的代码都忘掉吧！我们不可能用那么麻烦的方式输出日志。</p>
<p>当然，如果你已将之前的知识掌握，那么概念与印象会留在脑海中一直帮助你学习后面的姿势。</p>
<p>日志库采用模块化方法，并提供几类组件：记录器、处理器、过滤器和格式器。</p>
<ul>
<li>记录器（loggers）提供应用程序的调用接口。</li>
<li>处理器（handlers）将日志记录（由记录器创建）发送到适当的目标。</li>
<li>过滤器（filters）提供了更精细的附加功能，用于确定要输出的日志记录。</li>
<li>格式器（formatter）指定最终输出中日志记录的样式。</li>
</ul>
<p><img src="/2021/07/11/logging/image-20210705223833117.png" alt="logger的创建及使用"></p>
<h4 id="Logger"><a href="#Logger" class="headerlink" title="Logger"></a>Logger</h4><ol>
<li><p>提供应用程序的调用接口，公开了几种方法，以便应用程序可以在运行时记录消息。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># logger是单例的，我们通过名字获取了logger，或者如果没有则返回 root。</span></span><br><span class="line">logger = logging.getLogger(__name__)</span><br></pre></td></tr></table></figure></li>
<li><p>决定日志记录的级别。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定记录器将处理的最低严重性日志消息</span></span><br><span class="line">logger.setLevel()</span><br></pre></td></tr></table></figure>
<p> 例如，如果严重性级别为 INFO ，则记录器将仅处理 INFO 、 WARNING 、 ERROR 和 CRITICAL 消息，并将忽略 DEBUG 消息。</p>
</li>
<li><p>将日志内容传递到相关联的handles。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从记录器对象中添加和删除处理器对象。</span></span><br><span class="line">logger.addHandler()</span><br><span class="line">logger.removeHandler()</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>logger的名称</strong></p>
<p>默认为root</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">logger = logging.getLogger()</span><br><span class="line"><span class="built_in">print</span>(logger)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(logger))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;RootLogger root (WARNING)&gt;</span></span><br><span class="line"><span class="string">&lt;class &#x27;logging.RootLogger&#x27;&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>当指定名字后：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">logger = logging.getLogger(<span class="string">&#x27;damon&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(logger)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(logger))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;Logger damon (WARNING)&gt;</span></span><br><span class="line"><span class="string">&lt;class &#x27;logging.Logger&#x27;&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>类型也发生了改变。</p>
<h4 id="Handlers"><a href="#Handlers" class="headerlink" title="Handlers"></a>Handlers</h4><p>它们将日志分发到不同的目的地。可以是文件、标准输出、邮件、或者通过socket、html等协议发送到任何地方。</p>
<p>最常用的handler主要有：</p>
<p><strong>StreamHandler</strong></p>
<p>标准输出stdout（如显示器）分发器。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh = logging.StreamHandler(Stream=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<p><strong>FileHandler</strong></p>
<p>继承自StreamHandler，将日志保存到磁盘文件处理器。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fh = logging.FileHandler(filename, mode=<span class="string">&#x27;a&#x27;</span>, encoding=<span class="literal">None</span>, delay=<span class="literal">False</span>, errors=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<p>当然，还有其他的，其中这两个是很好用的：</p>
<p><code>RotatingFileHandler</code> 实例将消息发送到硬盘文件，支持最大日志文件大小和日志文件轮换。</p>
<p><code>TimedRotatingFileHandler</code> 实例将消息发送到硬盘文件，以特定的时间间隔轮换日志文件。</p>
<h4 id="Formatter"><a href="#Formatter" class="headerlink" title="Formatter"></a>Formatter</h4><p>格式化器对象配置日志消息的最终顺序、结构和内容。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ft = logging.Formatter.__init__(fmt=<span class="literal">None</span>, datefmt=<span class="literal">None</span>, style=<span class="string">&#x27;%&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>比如我们可以把格式设定为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;%(asctime)s - %(levelname)s - %(message)s&#x27;</span><br></pre></td></tr></table></figure>

<p>上面出现的特殊格式的属性为  <em>LogRecord</em>  ，以下有更多的 <em>LogRecord</em> 属性可以参考：</p>
<table>
<thead>
<tr>
<th align="left">属性名称</th>
<th align="left">格式</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">args</td>
<td align="left">此属性不需要用户进行格式化。</td>
<td align="left">合并到 <code>msg</code> 以产生 <code>message</code> 的包含参数的元组，或是其中的值将被用于合并的字典（当只有一个参数且其类型为字典时）。</td>
</tr>
<tr>
<td align="left">asctime</td>
<td align="left"><code>%(asctime)s</code></td>
<td align="left">表示 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.9/library/logging.html#logging.LogRecord"><code>LogRecord</code></a> 何时被创建的供人查看时间值。 默认形式为 ‘2003-07-08 16:49:45,896’ （逗号之后的数字为时间的毫秒部分）。</td>
</tr>
<tr>
<td align="left">created</td>
<td align="left"><code>%(created)f</code></td>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.9/library/logging.html#logging.LogRecord"><code>LogRecord</code></a> 被创建的时间（即 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.9/library/time.html#time.time"><code>time.time()</code></a> 的返回值）。</td>
</tr>
<tr>
<td align="left">exc_info</td>
<td align="left">此属性不需要用户进行格式化。</td>
<td align="left">异常元组（例如 <code>sys.exc_info</code>）或者如未发生异常则为 <code>None</code>。</td>
</tr>
<tr>
<td align="left">filename</td>
<td align="left"><code>%(filename)s</code></td>
<td align="left"><code>pathname</code> 的文件名部分。</td>
</tr>
<tr>
<td align="left">funcName</td>
<td align="left"><code>%(funcName)s</code></td>
<td align="left">函数名包括调用日志记录.</td>
</tr>
<tr>
<td align="left">levelname</td>
<td align="left"><code>%(levelname)s</code></td>
<td align="left">消息文本记录级别（<code>&#39;DEBUG&#39;</code>，<code>&#39;INFO&#39;</code>，<code>&#39;WARNING&#39;</code>，<code>&#39;ERROR&#39;</code>，<code>&#39;CRITICAL&#39;</code>）。</td>
</tr>
<tr>
<td align="left">levelno</td>
<td align="left"><code>%(levelno)s</code></td>
<td align="left">消息数字的记录级别 (<code>DEBUG</code>, <code>INFO</code>, <code>WARNING</code>, <code>ERROR</code>, <code>CRITICAL</code>).</td>
</tr>
<tr>
<td align="left">lineno</td>
<td align="left"><code>%(lineno)d</code></td>
<td align="left">发出日志记录调用所在的源行号（如果可用）。</td>
</tr>
<tr>
<td align="left">message</td>
<td align="left"><code>%(message)s</code></td>
<td align="left">记入日志的消息，即 <code>msg % args</code> 的结果。 这是在发起调用 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.9/library/logging.html#logging.Formatter.format"><code>Formatter.format()</code></a> 时设置的。</td>
</tr>
<tr>
<td align="left">module</td>
<td align="left"><code>%(module)s</code></td>
<td align="left">模块 (<code>filename</code> 的名称部分)。</td>
</tr>
<tr>
<td align="left">msecs</td>
<td align="left"><code>%(msecs)d</code></td>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.9/library/logging.html#logging.LogRecord"><code>LogRecord</code></a> 被创建的时间的毫秒部分。</td>
</tr>
<tr>
<td align="left">msg</td>
<td align="left">此属性不需要用户进行格式化。</td>
<td align="left">在原始日志记录调用中传入的格式字符串。 与 <code>args</code> 合并以产生 <code>message</code>，或是一个任意对象 (参见 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.9/howto/logging.html#arbitrary-object-messages">使用任意对象作为消息</a>)。</td>
</tr>
<tr>
<td align="left">name</td>
<td align="left"><code>%(name)s</code></td>
<td align="left">用于记录调用的日志记录器名称。</td>
</tr>
<tr>
<td align="left">pathname</td>
<td align="left"><code>%(pathname)s</code></td>
<td align="left">发出日志记录调用的源文件的完整路径名（如果可用）。</td>
</tr>
<tr>
<td align="left">process</td>
<td align="left"><code>%(process)d</code></td>
<td align="left">进程ID（如果可用）</td>
</tr>
<tr>
<td align="left">processName</td>
<td align="left"><code>%(processName)s</code></td>
<td align="left">进程名（如果可用）</td>
</tr>
<tr>
<td align="left">relativeCreated</td>
<td align="left"><code>%(relativeCreated)d</code></td>
<td align="left">以毫秒数表示的 LogRecord 被创建的时间，即相对于 logging 模块被加载时间的差值。</td>
</tr>
<tr>
<td align="left">stack_info</td>
<td align="left">此属性不需要用户进行格式化。</td>
<td align="left">当前线程中从堆栈底部起向上直到包括日志记录调用并引发创建当前记录堆栈帧创建的堆栈帧信息（如果可用）。</td>
</tr>
<tr>
<td align="left">thread</td>
<td align="left"><code>%(thread)d</code></td>
<td align="left">线程ID（如果可用）</td>
</tr>
<tr>
<td align="left">threadName</td>
<td align="left"><code>%(threadName)s</code></td>
<td align="left">线程名（如果可用）</td>
</tr>
</tbody></table>
<h5 id="关于日志对齐"><a href="#关于日志对齐" class="headerlink" title="关于日志对齐"></a>关于日志对齐</h5><ul>
<li><code>%(levelname)8s</code>:右对齐</li>
<li><code>%(levelname)-8s</code>:左对齐</li>
</ul>
<h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>传统的方式是以<code>.config</code>结尾的方式进行配置。</p>
<p>在 Python 3.2 中，引入了一种新的配置日志记录的方法，使用字典来保存配置信息。 这提供了上述基于配置文件方法的功能的超集，并且是新应用程序和部署的推荐配置方法。 因为 Python 字典用于保存配置信息，并且由于你可以使用不同的方式填充该字典，因此你有更多的配置选项。 例如，你可以使用 JSON 格式的配置文件，或者如果你有权访问 YAML 处理功能，则可以使用 YAML 格式的文件来填充配置字典。当然，你可以在 Python 代码中构造字典，通过套接字以 pickle 形式接收它，或者使用对你的应用程序合理的任何方法。</p>
<p>补充一个我在Django中设计的配置文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">LOGGING = &#123;</span><br><span class="line">    <span class="string">&#x27;version&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&#x27;disable_existing_loggers&#x27;</span>: <span class="literal">False</span>,</span><br><span class="line">    <span class="string">&#x27;formatters&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;verbose&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;format&#x27;</span>: <span class="string">&#x27;%(asctime)s[%(levelname)8s]%(name)s(%(module)s:%(lineno)d) %(funcName)s %(message)s&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;simple&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;format&#x27;</span>: <span class="string">&#x27;&#123;levelname&#125; &#123;message&#125;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;style&#x27;</span>: <span class="string">&#x27;&#123;&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;filters&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;require_debug_false&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;()&#x27;</span>: <span class="string">&#x27;django.utils.log.RequireDebugFalse&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;require_debug_true&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;()&#x27;</span>: <span class="string">&#x27;django.utils.log.RequireDebugTrue&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;handlers&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;console&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;INFO&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;filters&#x27;</span>: [<span class="string">&#x27;require_debug_true&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;logging.StreamHandler&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;formatter&#x27;</span>: <span class="string">&#x27;verbose&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;file&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;WARNING&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;filters&#x27;</span>: [<span class="string">&#x27;require_debug_false&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;logging.handlers.TimedRotatingFileHandler&#x27;</span>,  <span class="comment"># 按时间进行文件切割的文件handler</span></span><br><span class="line">            <span class="string">&#x27;formatter&#x27;</span>: <span class="string">&#x27;verbose&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;filename&#x27;</span>: os.path.join(BASE_LOG_DIR, <span class="string">&#x27;log.log&#x27;</span>),</span><br><span class="line">            <span class="string">&#x27;when&#x27;</span>: <span class="string">&#x27;D&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;backupCount&#x27;</span>: <span class="number">90</span>,  <span class="comment"># 超过90天的日志会被删除</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;loggers&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;&#x27;</span>: &#123;  <span class="comment"># 默认的logger应用如下配置</span></span><br><span class="line">            <span class="string">&#x27;handlers&#x27;</span>: [<span class="string">&#x27;console&#x27;</span>, <span class="string">&#x27;file&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;DEBUG&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;propagate&#x27;</span>: <span class="literal">True</span>  <span class="comment"># 要不要传播到更高级处理</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment"># 类型 为 django 处理所有类型的日志， 默认调用</span></span><br><span class="line">        <span class="string">&#x27;django&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;handlers&#x27;</span>: [<span class="string">&#x27;console&#x27;</span>, <span class="string">&#x27;file&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;DEBUG&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;propagate&#x27;</span>: <span class="literal">False</span>  <span class="comment"># 要不要传播到更高级处理</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h3><h4 id="logger-execption"><a href="#logger-execption" class="headerlink" title="logger.execption()"></a>logger.execption()</h4><p>使用<code>logger.execption()</code>可以传入一个捕获到的异常，将其打印。</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ol>
<li>日志 HOWTO，作者：Vinay Sajip<br><a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/howto/logging.html">https://docs.python.org/zh-cn/3/howto/logging.html</a></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shoucy.github.io/2021/07/11/logging/" data-id="ckrgf8jik00091svhgt5r2tvk" data-title="logging——python日志模块" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/07/19/Docker/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Neuer</strong>
      <div class="article-nav-title">
        
          Docker
        
      </div>
    </a>
  
  
    <a href="/2021/06/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Älter</strong>
      <div class="article-nav-title">计算机基本概念</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Kategorien</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">编程学习笔记</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/python/">python</a></li></ul></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/07/19/Docker/">Docker</a>
          </li>
        
          <li>
            <a href="/2021/07/11/logging/">logging——python日志模块</a>
          </li>
        
          <li>
            <a href="/2021/06/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/">计算机基本概念</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 Shou Chengyu<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>